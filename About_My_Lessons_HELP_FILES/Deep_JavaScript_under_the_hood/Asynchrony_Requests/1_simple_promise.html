<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Promise</title>
</head>

<body>
    <script>
        //

        /*
            ิฑีฝีซีถีญึีธึีถีธึีฉีตีกีถ ีดีซีปีธึีธีพ ีฝีซีดีธึีฌีกึีซีก ีกีถีฅีถึ ีกีฝีต ีทีฒีฉีกีตีกีฏีกีถ ีฏีกีบีจ, Promise-ีธีพ
            Client -> Server -> DataBase -> Server -> Client
            ีึีซีถีกีฏี
        */


        /*
        โซ Promise-ีจ ีถีกีญีกีฟีฅีฝีพีกีฎ ีง ีกีฝีซีถีญึีธีถ ีญีถีคีซึีถีฅึีจ ีกีพีฅีฌีซ ีฐีฅีทีฟ ีฌีธึีฎีฅีฌีธึ ีฐีกีดีกึึ
        Promise ีฐีกีฝีฏีกึีธีฒีธึีฉีตีกีถ ีฃีกีฒีกึีกึีจ ีฏีกีตีกีถีธึีด ีถึีกีถีธึีด, ีธึ ีดีฅีถึ ีฝีฟีฅีฒีฎีธึีด ีฅีถึ ึีขีตีฅีฏีฟ ีธึีซ ีกีถีธึีถีจ Promise ีง, ีธึ ีซึีก ีดีฅีป ีฃึีธึีด ีฅีถึ ีกีฝีซีถีญึีธีถ ีฏีธีคึ
        */

        /*
        Promise constructor-ีซ ีกีผีกีปีซีถ ีบีกีผีกีดีฅีฟึีจ callback ึีธึีถีฏึีซีก ีง, ึ ีกีตีค ึีธึีถีฏึีซีกีถ ีจีถีคีธึีถีธึีดีก 2 ีบีกีผีกีดีฅีฟึี
            1โค
            2โค
        
        */
        // let promise = new Promise(function() {//โ ีกีตีฝ ึีธึีถีฏึีซีกีถ ีกีถีดีซีปีกีฏีถีธึ ีฅีถ ีง ีฏีกีฟีกึีพีฅีฌีธึ ??
        //     //ีกีตีฟีฅีฒ ีฏีกีฟีกึีพีธึีด ีง ึีกีถีฏีกึีกีฎ ีกีฝีซีถีญึีธีถ ีฏีธีค
        // });


        /*
        ////โ ีีฅีถึ ีฅีถึ ีฆีฃีธึีทีกึีถีธึีด promise-ีซีถ ีธึ ีดีฅึ ีกีฝีซีถีญีนีธีถ ีฏีธีคีซ ีฅีฝีซีถีณ ึีธึีฌีจ ีกีพีกึีพีฅีฌีก, ีซีฝีฏ ีคึีก ีฐีกีดีกึี
        resolve ึ reject ีคึีกีถีง callback ึีธึีถีฏึีซีกีถีฅึ ีฅีถี
    
        resolve - ีดีฅีฆ ีฆีฃีธึีทีกึีถีธึีดีก ีกีตีถ ีดีกีฝีซีถ, ีธึ ีกีฝีซีถีญึีธีถ ีฏีธีคีจ ีกีฐีกีปีฒีธึีฉีตีกีดีข ีกีพีกึีพีฅีฌ ีงึ
        reject - ีจ ีดีฅีฆ ีฆีฃีธึีทีกึีถีธึีดีก ีกีตีถ ีดีกีฝีซีถ, ีธึ ีฟีฅีฒีซ ีง ีธึีถีฅึีฅีฌ ีซีถีน-ีธึ ีฝีญีกีฌ
        */



        console.log('Client : ีธึีฆีธึีด ีฅีด ีฝีฟีกีถีกีฌ ึีฃีพีธีฒีถีฅึ ึีกีถีฏีจ');//
        console.log('...');//ีชีกีดีกีถีกีฏีกีฟีกึ ีง

        let promise = new Promise(function (resolve, reject) {//โ ีกีตีฝ ึีธึีถีฏึีซีกีถ ีกีถีดีซีปีกีฏีถีธึ ีฅีถ ีง ีฏีกีฟีกึีพีฅีฌีธึ 
            setTimeout(function () {
                console.log('Server : ีฐีกึึีถีธึีด ีฅีด DataBase -ีซีถ ึีฃีพีธีฒีถีฅึ ึีกีถีฏีจ');
                console.log('...');//ีชีกีดีกีถีกีฏีกีฟีกึ ีง 
                //ีฆีฃีธึีทีกึีถีธึีด ีฅีถึ promise-ีซีถ, ีธึ ีฅีฝ ึีธึีฌีจ ีกีพีกึีพีฅีฌีก resolve ึีธึีถีฏึีซีกีถ ีฏีกีถีนีฅีฌีธีพึ
                resolve();
            }, 1000)
        });

        ////ีีฅีถีก ีธึีถีฅีถึ promise ึีธึีธีญีกีฏีกีถ, ีธึีจ ีกีฏีธึีฒ ีฅีถึ ึีฃีฟีกีฃีธึีฎีฅีฌ ึีกีถีฏีกึีกีฎ ีฟีฅีฒ ีดีฅึ ีฏีธีคีธึีดึ

        /*
        Promise ึีขีตีฅีฏีฟีจ ีธึีถีซ 2 ีฐีฅีฟีกึึึีซึ ีดีฅีฉีธีคึ
        1.then( ) ีฐีฅีฟีธ - ีจ ีถีทีกีถีกีฏีธึีดีก ีฅึีข ีซีถีน-ีธึ ีขีกีถ ีฏีกีฟีกึีพีซ ีฏีกีถีฅีถึ resolve
        โิตึีข ีฏีกีฟีกึีพีซ resolve ีฐีฅีฟีธ ีฏีฏีกีฟีกึีพีซ then()
            Syntax of then()
                then(onResolved)
        2
        */

        promise.then(function () {
            //ิฑีตีฝ ีฏีธีคีจ ีฏีฏีกีฟีกึีพีซ ีฅึีข ีกีฝีซีถีญึีธีถ ีฏีธีคีจ ีฐีกีปีฉีฒีธึีฉีตีกีดีข ีฏีกีฟีกึีพีซ
            // let bdPromise = new Promise(function (resolve, reject) {//โ๐
            //     setTimeout(() => {
            //         ////ีึีบีฅีฝีฆีซ ีกีพีฅีฌีซ ีฌีกีพ ีฏีกีผีกีพีกึีฅีถึ ีดีฅึ setTimeout-ีจ ีดีฅีถึ ีถีธึ promise ีฏีฝีฟีฅีฒีฎีฅีถึ ีธึ ีดีฅึ timeout-ีจ ีฏีบีกีฐีฅีถึ ีดีฅีปีจึ
            //         console.log('DataBase: ีฑึีกีฏีฅึีบีธึีด ีฅีด ึีฃีพีธีฒีถีฅึีซ ึีกีถีฏีจ ีธึ ึีธีญีกีถึีฅีด Server-ีซีถ');
            //         console.log('...');//ีชีกีดีกีถีกีฏีกีฟีกึ ีง 
            //         //ิตึีข ีกีฝีซีถีญึีธีถ ีฏีธีคีจ ีฐีกีปีธีฒีธึีฉีตีกีดีข  ีกีพีกึีฟีพีซ ีดีฅีถึ ีฏีฏีกีถีนีฅีถึ resolve()
            //         resolve();
            //     }, 500);
            // });
            /*
            โ ิฑีผีกีปีซีถ ีฐีกีตีกึึีซึ ีฉีพีธึีดีก, ีธึ promise-ีถีฅึีจ ีนีฅีถ ึีฃีถีซ,ีธึีธีพีฐีฅีฟึ ีฏีดีฟีกีฎีฅึ, then-ีซ ีดีฅีป ีบีฅีฟึีก ีถีธึีซึ promise ีฃึีฅีฌ, ีฅีฉีฅ ีกีตีคีบีฅีฝ ีกีถีฅีถึ ีดีฅีถึ ีถีธึีซึ ีฏีฝีฏีฝีฅึีถ ีญีกึีกีถีกีกีฌ, callback in callbackึ
            bdPromise.then(function(){//๐ญ

            });
            ๐๐
            ิดึีก ีฐีกีดีกึ ีดีฅีถึ ีฏีฃึีฅีถึ ึีธึีธีญีกีฏีกีถีซ ีดีฅีป ีบีกีฐีฅีฌีธึ ึีธีญีกึีฅีถ ีดีฅีถึ ีดีฅึ then-ีซ ีดีฅีปีซ promise ีฏีพีฅึีกีคีกึีฑีถีฅีถึ ีึีซีถีกีฏี 
            */
            
            return new Promise(function (resolve,reject) {//โ๐
                setTimeout(function () {
                    console.log('DataBase: ีฑึีกีฏีฅึีบีธึีด ีฅีด ึีฃีพีธีฒีถีฅึีซ ึีกีถีฏีจ ีธึ ึีธีญีกีถึีฅีด Server-ีซีถ');
                    console.log('...');//ีชีกีดีกีถีกีฏีกีฟีกึ ีง 
                    resolve();
                }, 500);
            })
                .then(function () {
                    return new Promise(function (resolve,reject) {//โ๐
                        setTimeout(function () {
                            console.log('Server : ึีธีญีกีฏีฅึีบีธึีด ีฅีด, ีธึ ีฟีกีด Client-ีซีถ');
                            console.log('...');//ีชีกีดีกีถีกีฏีกีฟีกึ ีง 
                            resolve();
                        }, 500);
                    })
                })
                .then(function() {
                    setTimeout(function() {
                        console.log('Client: ีฝีฟีกึีก Server-ีซึ ึีธีญีกีฏีฅึีบีพีกีฎ ีฟีพีตีกีฌีถีฅึีจึ ีึ ีฐีซีดีก ึีธึึีกีคึีธึีด ีฅีถึ ีกีตีค ีฟีพีตีกีฌีถีฅึีจึ');
                    },1000);
                })
                .catch(function(error){
                    console.error(error);
                    
                })
                // .finally(function() {
                //     console.log('Finally')
                // })
        })
        /*
        * ิฟีธีคีจ ีซึีกีฏีกีถีธึีด ีกีพีฅีฌีซ ีทีกีฟ ีฅีฒีกีพ ึีกีถ setTimeout-ีถีฅึีธีพ, ีขีกีตึ ีฐีฅีฟีกีฃีกีตีธึีด ีธึ ีดีฅีถึ ีฝีฏีฝีฅีถึ ีกีทีญีกีฟีฅีฌ ีดีธีคีธึีฌีถีฅึีซ ีฐีฅีฟ , ีดีฅีถึ ีฏีฏีกึีธีฒีกีถีกีถึ ีฟีกึีขีฅึ ึีกีตีฌีฅึีซ ีดีฅีป then ีดีฅีฉีธีคีจ ีฏีกีถีนีฅีฌึ
        * ิฒีกึีซ ีคีก ีฅีฝ ีฃึีฅีฌีกีฑึีจ ีกีพีฅีฌีซ ีฐีกึีดีกึ ีฃึีฅีกีฌีกีฑึีก ีธึีธีพีฐีฅีฟึ ีดีฅึีถ ีซึีกึ ีฟีกีฏ ีฐีกีปีธึีคีกีขีกึ ีกีฝีซีถีญึีธีถ ีฏีธีค ีฅีถึ ีฃึีธึีด ีธีน ีฉีฅ ีซึีกึ ีดีฅีปึ

        * ีีกึ promise-ีจ ีขีกึีซ then-ีซึ ีธึีถีซ ึีฝ 2 ีดีฅีฉีธีคี
            catch() - ีจ ีถีกีญีกีฟีฅีฝีพีกีฎีจ regected-ีซ ีชีกีดีกีถีกีฏ ีซีถีน-ีธึ ีฃีธึีฎีธีฒีธึีฉีตีธึีถ ีกีถีฅีฌีธึ ีฐีกีกีดีกึึ ิฑีตีฝีซีถึึีถ ีฅึีข ีดีฅึ ีกีฝีซีถีญึีธีถ ีฏีธีคีธึีด ีฝีญีกีฌ ีฟีฅีฒีซ ีธึีถีฅีถีกึ
            โ ีดีฅึ ีกีฝีซีถีญึีธีถ ีฏีธีคีซ ึีกีถีฏีกึีกีฎ ึีธึีฌีซ ีชีกีดีกีถีกีฏ ีธึ ีฝีญีกีฌ ีฟีฅีฒีซ ีธึีถีฅีถีก, ีฏีกึีก ีกีทีญีกีฟีซ ีดีซ ีฐีกีฟ catch ีธีน ีฉีฅ ีกีดีกีถ ีกีถีกีฃีกีด ีกีดีฅีถีด ีดีซ setTmeout-ีซ ีฐีกีดีกึ ีถีธึ try...catch ีฝีกึึีฅีถึึ

        * ีฅีฌ ีซีถีน ีฏีกึีฅีฌีซีก ีง ีกีถีฅีฌ promise-ีถีฅึีซ ีฐีฅีฟ, finaly
        finally() - ีดีฅีฉีธีคีจ ีฏีฏีกีถีนีพีซ ีฅีถ ีชีกีดีกีถีกีฏ ีฅึีข ีธีฒีป ีกีฝีถีซีญึีธีถ ึีบีฅึีกึีซีกีถีฅึีจ ีฏีกีฟีกึีพีฅีถึ ีีธึีตีถีซีฝีฏ ีฅีฉีฅ ีซีถีน-ีธึ ีฝีญีกีฌ ีฟีฅีฒีซ ีธึีถีฅีถีก ีธึ ีทีฒีฉีกีตีกีฏีกีถ ีฏีกีบีจ ีจีถีฐีกีฟีพีซ, ีถีธึีซึ ีฏีฏีกีถีนีพีซ finally ีดีฅีฉีธีคีจึ
        โ ิฑีตีฝีซีถึีถ ีกีดีฅีถ ีคีฅีบึีธึีด ีฃีธึีฎีธีฒีธึีฉีตีธึีถ ีฏีฏีกีฟีกึีพีซึ 
        */

    </script>
</body>

</html>